---
import { DISQUS_SHORTNAME } from '@/config';
---

<div
  id="disqus_thread"
  data-shortname={DISQUS_SHORTNAME}
  data-url={Astro.url.href}
  data-identifier={Astro.url.pathname.replace('/', '')}
>
  <noscript
    >Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript"
      >comments powered by Disqus.</a
    ></noscript
  >
</div>
<script defer>
  (function () {
    const r = document.getElementById('disqus_thread');
    // @ts-ignore
    window.disqus_config = function () {
      this.page.url = r.getAttribute('data-url');
      this.page.identifier = r.getAttribute('data-identifier');
    };
    var d = window.document,s = d.createElement('script');
    s.src = '//' + r.getAttribute('data-shortname') + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', Date.now());
    (d.head || d.body).appendChild(s);
  })();
</script>
